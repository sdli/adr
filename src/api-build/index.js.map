{"version":3,"sources":["../api/index.js"],"names":["app","port","apiPort","use","secret","resave","saveUninitialized","cookie","secure","urlencoded","extended","post","loginStart","loadAuth","countryList","countryReport","villageReport","getChildDetails","req","res","next","changePassword","body","passwordnew1","passwordnew2","passwordold","userId","download","get","loadImg","shenhe","action","applyId","level","operatorId","remark","listen","logout"],"mappings":";;AAAA;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;AAEA;AACA,IAAMA,MAAM,uBAAZ;AACA,IAAMC,OAAQ,kBAAQC,OAAtB;;AAEA;AACAF,IAAIG,GAAJ,CAAQ,6BAAR;AACAH,IAAIG,GAAJ,CAAQ,8BAAQ;AACdC,UAAQ,aADM;AAEdC,UAAQ,IAFM;AAGdC,qBAAmB,KAHL;AAIdC,UAAQ,EAACC,QAAQ,KAAT,CAAgB;AAAhB,GAJM,EAAR,CAAR;;AAOA;AACAR,IAAIG,GAAJ,CAAQ,qBAAWM,UAAX,CAAsB,EAAEC,UAAU,KAAZ,EAAtB,CAAR;;AAEA;AACAV,IAAIW,IAAJ,CAAS,QAAT,EAAmB,cAAKC,UAAxB;;AAEA;AACAZ,IAAIW,IAAJ,CAAS,WAAT,EAAqB,cAAKE,QAA1B;;AAEA;AACAb,IAAIW,IAAJ,CAAS,cAAT,EAAwB,cAAKG,WAA7B;;AAEA;AACAd,IAAIW,IAAJ,CAAS,gBAAT,EAA0B,cAAKI,aAA/B;;AAEA;AACAf,IAAIW,IAAJ,CAAS,gBAAT,EAA0B,cAAKK,aAA/B;;AAEA;AACAhB,IAAIW,IAAJ,CAAS,kBAAT,EAA4B,cAAKM,eAAjC;;AAEA;AACAjB,IAAIW,IAAJ,CAAS,iBAAT,EAA2B,UAASO,GAAT,EAAaC,GAAb,EAAiBC,IAAjB,EAAsB;AAC3C,gBAAKC,cAAL,CAAoBH,GAApB,EAAwBC,GAAxB,EACI;AACE,cAAUD,IAAII,IAAJ,CAASC,YADrB;AAEE,qBAAiBL,IAAII,IAAJ,CAASE,YAF5B;AAGE,cAAUN,IAAII,IAAJ,CAASG,WAHrB;AAIE,cAAUP,IAAII,IAAJ,CAASI;AAJrB,GADJ;AAQL,CATD;;AAWA;AACA1B,IAAIW,IAAJ,CAAS,WAAT,EAAqB,cAAKgB,QAA1B;;AAEA;AACA3B,IAAI4B,GAAJ,CAAQ,MAAR,EAAe,cAAKC,OAApB;;AAEA;AACA7B,IAAIW,IAAJ,CAAS,SAAT,EAAmB,UAASO,GAAT,EAAaC,GAAb,EAAiBC,IAAjB,EAAsB;AACrC,gBAAKU,MAAL,CAAYZ,GAAZ,EAAgBC,GAAhB,EAAoB;AAChBY,YAAOb,IAAII,IAAJ,CAASS,MADA;AAEhBC,aAAQd,IAAII,IAAJ,CAASU,OAFD;AAGhBC,WAAMf,IAAII,IAAJ,CAASW,KAHC;AAIhBC,gBAAWhB,IAAII,IAAJ,CAASY,UAJJ;AAKhBC,YAAOjB,IAAII,IAAJ,CAASa;AALA,GAApB;AAQH,CATD;;AAWA;AACAnC,IAAIoC,MAAJ,CAAWnC,IAAX,EAAgB,cAAKmC,MAArB;;AAEA;AACApC,IAAI4B,GAAJ,CAAQ,SAAR,EAAkB,cAAKS,MAAvB","file":"index.js","sourcesContent":["import \"babel-polyfill\";\r\nimport express from 'express';\r\nimport bodyParser from \"body-parser\";\r\nimport configs from \"./utils/configs\"; \r\nimport session from \"express-session\";\r\nimport cookieParser from \"cookie-parser\";\r\nimport apis from \"./lib/\";\r\n\r\n// express库\r\nconst app = new express();\r\nconst port  = configs.apiPort;\r\n\r\n// 配置传输session和cookie\r\napp.use(cookieParser());\r\napp.use(session({\r\n  secret: 'sessiontest',\r\n  resave: true,\r\n  saveUninitialized: false,\r\n  cookie: {secure: false} //不设置过期时间\r\n}));\r\n\r\n//配置解析工具\r\napp.use(bodyParser.urlencoded({ extended: false}));\r\n\r\n// 登录接口\r\napp.post('/login', apis.loginStart);\r\n\r\n// 加载权限\r\napp.post('/loadAuth',apis.loadAuth);\r\n\r\n// 加载镇级别列表\r\napp.post(\"/countryList\",apis.countryList);\r\n\r\n// 加载镇级别报告\r\napp.post(\"/countryReport\",apis.countryReport);\r\n\r\n// 加载村别报告\r\napp.post(\"/villageReport\",apis.villageReport);\r\n\r\n// 加载儿童详情\r\napp.post(\"/getChildDetails\",apis.getChildDetails);\r\n\r\n// 修改密码\r\napp.post(\"/changePassword\",function(req,res,next){\r\n      apis.changePassword(req,res,\r\n          {\r\n            \"newPwd\": req.body.passwordnew1,\r\n            \"newPwdConfirm\": req.body.passwordnew2,\r\n            \"oldPwd\": req.body.passwordold,\r\n            \"userId\": req.body.userId\r\n          }\r\n      );\r\n});\r\n\r\n// 下载excel\r\napp.post(\"/download\",apis.download);\r\n\r\n// 加载验证码\r\napp.get('/img',apis.loadImg);\r\n\r\n// 审核报告接口\r\napp.post(\"/shenhe\",function(req,res,next){\r\n    apis.shenhe(req,res,{\r\n        action:req.body.action,\r\n        applyId:req.body.applyId,\r\n        level:req.body.level,\r\n        operatorId:req.body.operatorId,\r\n        remark:req.body.remark\r\n      }\r\n    );\r\n});\r\n\r\n// 监听端口\r\napp.listen(port,apis.listen);\r\n\r\n// 登出操作\r\napp.get('/logout',apis.logout);"]}